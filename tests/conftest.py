import pandas as pd
import pytest


@pytest.fixture
def operations_list():
    return [
        {
            "category1": "apple",
            "category2": "banana",
            "Дата операции": "01.01.2021 18:08:23",
        },
        {
            "category1": "orange",
            "category2": "grape",
            "Дата операции": "01.02.2021 12:09:06",
        },
        {
            "category1": "banana",
            "category2": "apple",
            "Дата операции": "01.02.2021 18:43:51",
        },
    ]


@pytest.fixture
def operations_list_test():
    return [
        {
            "Дата операции": "01.01.2018 12:49:53",
            "Дата платежа": "01.01.2018",
            "Номер карты": "NaN",
            "Статус": "OK",
            "Сумма операции": -3000.0,
            "Валюта операции": "RUB",
            "Сумма платежа": -3000.0,
            "Валюта платежа": "RUB",
            "Кэшбэк": "NaN",
            "Категория": "Переводы",
            "MCC": "NaN",
            "Описание": "Линзомат ТЦ Юность",
            "Бонусы (включая кэшбэк)": 0,
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 3000.0,
        },
        {
            "Дата операции": "01.01.2018 20:27:51",
            "Дата платежа": "04.01.2018",
            "Номер карты": "*7197",
            "Статус": "OK",
            "Сумма операции": -316.0,
            "Валюта операции": "RUB",
            "Сумма платежа": -316.0,
            "Валюта платежа": "RUB",
            "Кэшбэк": "NaN",
            "Категория": "Красота",
            "MCC": 5977.0,
            "Описание": "OOO Balid",
            "Бонусы (включая кэшбэк)": 6,
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 316.0,
        },
        {
            "Дата операции": "01.01.2020 14:47:42",
            "Дата платежа": "04.01.2020",
            "Номер карты": "*4556",
            "Статус": "OK",
            "Сумма операции": -362.0,
            "Валюта операции": "RUB",
            "Сумма платежа": -362.0,
            "Валюта платежа": "RUB",
            "Кэшбэк": 3.0,
            "Категория": "Красота",
            "MCC": 5977.0,
            "Описание": "OOO Balid",
            "Бонусы (включая кэшбэк)": 3,
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 362.0,
        },
        {
            "Дата операции": "01.01.2021 18:08:23",
            "Дата платежа": "01.01.2021",
            "Номер карты": "*7197",
            "Статус": "OK",
            "Сумма операции": -815.68,
            "Валюта операции": "RUB",
            "Сумма платежа": -815.68,
            "Валюта платежа": "RUB",
            "Кэшбэк": "NaN",
            "Категория": "Супермаркеты",
            "MCC": 5411.0,
            "Описание": "Дикси",
            "Бонусы (включая кэшбэк)": 16,
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 815.68,
        },
        {
            "Дата операции": "01.02.2018 12:52:42",
            "Дата платежа": "03.02.2018",
            "Номер карты": "*7197",
            "Статус": "OK",
            "Сумма операции": -325.0,
            "Валюта операции": "RUB",
            "Сумма платежа": -325.0,
            "Валюта платежа": "RUB",
            "Кэшбэк": "NaN",
            "Категория": "Фастфуд",
            "MCC": 5814.0,
            "Описание": "OOO Frittella",
            "Бонусы (включая кэшбэк)": 6,
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 325.0,
        },
        {
            "Дата операции": "01.02.2018 20:05:44",
            "Дата платежа": "02.02.2018",
            "Номер карты": "*7197",
            "Статус": "OK",
            "Сумма операции": -325.0,
            "Валюта операции": "RUB",
            "Сумма платежа": -325.0,
            "Валюта платежа": "RUB",
            "Кэшбэк": "NaN",
            "Категория": "Фастфуд",
            "MCC": 5814.0,
            "Описание": "OOO Avrora Rusko",
            "Бонусы (включая кэшбэк)": 6,
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 325.0,
        },
        {
            "Дата операции": "01.02.2019 14:28:54",
            "Дата платежа": "03.02.2019",
            "Номер карты": "*7197",
            "Статус": "OK",
            "Сумма операции": -87.0,
            "Валюта операции": "RUB",
            "Сумма платежа": -87.0,
            "Валюта платежа": "RUB",
            "Кэшбэк": "NaN",
            "Категория": "Супермаркеты",
            "MCC": 5499.0,
            "Описание": "Колхоз",
            "Бонусы (включая кэшбэк)": 1,
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 87.0,
        },
        {
            "Дата операции": "01.02.2020 14:54:09",
            "Дата платежа": "03.02.2020",
            "Номер карты": "*7197",
            "Статус": "OK",
            "Сумма операции": -49.99,
            "Валюта операции": "RUB",
            "Сумма платежа": -49.99,
            "Валюта платежа": "RUB",
            "Кэшбэк": "NaN",
            "Категория": "Фастфуд",
            "MCC": 5814.0,
            "Описание": "Бургер Кинг",
            "Бонусы (включая кэшбэк)": 0,
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 49.99,
        },
        {
            "Дата операции": "01.02.2020 16:14:24",
            "Дата платежа": "03.02.2020",
            "Номер карты": "*7197",
            "Статус": "OK",
            "Сумма операции": -49.99,
            "Валюта операции": "RUB",
            "Сумма платежа": -49.99,
            "Валюта платежа": "RUB",
            "Кэшбэк": "NaN",
            "Категория": "Фастфуд",
            "MCC": 5814.0,
            "Описание": "Бургер Кинг",
            "Бонусы (включая кэшбэк)": 0,
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 49.99,
        },
        {
            "Дата операции": "01.02.2020 17:46:16",
            "Дата платежа": "03.02.2020",
            "Номер карты": "*7197",
            "Статус": "OK",
            "Сумма операции": -151.88,
            "Валюта операции": "RUB",
            "Сумма платежа": -151.88,
            "Валюта платежа": "RUB",
            "Кэшбэк": "NaN",
            "Категория": "Супермаркеты",
            "MCC": 5499.0,
            "Описание": "Колхоз",
            "Бонусы (включая кэшбэк)": 3,
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 151.88,
        },
        {
            "Дата операции": "01.02.2021 12:09:06",
            "Дата платежа": "01.02.2021",
            "Номер карты": "*7197",
            "Статус": "OK",
            "Сумма операции": -96.0,
            "Валюта операции": "RUB",
            "Сумма платежа": -96.0,
            "Валюта платежа": "RUB",
            "Кэшбэк": "NaN",
            "Категория": "Супермаркеты",
            "MCC": 5499.0,
            "Описание": "Колхоз",
            "Бонусы (включая кэшбэк)": 1,
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 96.0,
        },
        {
            "Дата операции": "01.02.2021 14:13:15",
            "Дата платежа": "01.02.2021",
            "Номер карты": "*7197",
            "Статус": "OK",
            "Сумма операции": -30.0,
            "Валюта операции": "RUB",
            "Сумма платежа": -30.0,
            "Валюта платежа": "RUB",
            "Кэшбэк": "NaN",
            "Категория": "Связь",
            "MCC": 7379.0,
            "Описание": "Devajs Servis.",
            "Бонусы (включая кэшбэк)": 0,
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 30.0,
        },
        {
            "Дата операции": "01.02.2021 16:12:01",
            "Дата платежа": "01.02.2021",
            "Номер карты": "*7197",
            "Статус": "OK",
            "Сумма операции": -99.0,
            "Валюта операции": "RUB",
            "Сумма платежа": -99.0,
            "Валюта платежа": "RUB",
            "Кэшбэк": "NaN",
            "Категория": "Фастфуд",
            "MCC": 5814.0,
            "Описание": "Pingvin Kofe I Chaj",
            "Бонусы (включая кэшбэк)": 1,
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 99.0,
        },
        {
            "Дата операции": "01.02.2021 18:43:51",
            "Дата платежа": "01.02.2021",
            "Номер карты": "*7197",
            "Статус": "OK",
            "Сумма операции": -357.96,
            "Валюта операции": "RUB",
            "Сумма платежа": -357.96,
            "Валюта платежа": "RUB",
            "Кэшбэк": "NaN",
            "Категория": "Супермаркеты",
            "MCC": 5411.0,
            "Описание": "Магнит",
            "Бонусы (включая кэшбэк)": 7,
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 357.96,
        },
        {
            "Дата операции": "01.03.2018 13:04:11",
            "Дата платежа": "03.03.2018",
            "Номер карты": "*7197",
            "Статус": "OK",
            "Сумма операции": -320.0,
            "Валюта операции": "RUB",
            "Сумма платежа": -320.0,
            "Валюта платежа": "RUB",
            "Кэшбэк": "NaN",
            "Категория": "Фастфуд",
            "MCC": 5814.0,
            "Описание": "OOO Frittella",
            "Бонусы (включая кэшбэк)": 6,
            "Округление на инвесткопилку": 0,
            "Сумма операции с округлением": 320.0,
        },
    ]
